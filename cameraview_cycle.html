<!doctype html>
<!--
   ___                                       _
  / __\__ _ _ __ ___   ___ _ __ __ _  /\   /(_) _____      __
 / /  / _` | '_ ` _ \ / _ \ '__/ _` | \ \ / / |/ _ \ \ /\ / /
/ /__| (_| | | | | | |  __/ | | (_| |  \ V /| |  __/\ V  V /
\____/\__,_|_| |_| |_|\___|_|  \__,_|   \_/ |_|\___| \_/\_/


Usage:
  Append URL parameters to control the embedded video.

Parameters:
  ?video=sheep|reef|ospreys|jellyfish|fish|eagles|africa
      Select a predefined video by name.
  ?code=<YouTubeVideoId>
      Override the video with any valid YouTube ID (takes precedence over ?video).
  ?mute=1|0
      1 (default) mutes to allow autoplay; 0 requests sound (autoplay may be blocked until user interacts).

Examples:
  page.html?video=reef
  page.html?video=ospreys&mute=0
  page.html?code=K380RGUXHsw&mute=1

Notes:
  Autoplay with sound can be blocked by browser policies; keep mute=1 for reliable autoplay.
  If you need sound immediately, user must interact (click/tap) before unmuting via the YouTube IFrame API.
-->

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Embedded Video</title>
    <meta name="referrer" content="strict-origin-when-cross-origin" />
    <style>
      html,
      body {
        margin: 0;
        height: 100%;
        background: #000;
      }
      iframe {
        position: fixed;
        inset: 0;
        width: 100vw;
        height: 100vh;
        border: 0;
      }
    </style>
  </head>
  <body>
    <iframe
      id="vidFrame"
      title="Video"
      allow="autoplay; fullscreen; picture-in-picture; encrypted-media"
      allowfullscreen
      referrerpolicy="strict-origin-when-cross-origin"
    >
    </iframe>
    <script>
      const configLocation =
        "https://willavos.github.io/camera-view/config.json";


      var config = await fetch(configLocation).then((r) => r.json());


      const base = "https://www.youtube-nocookie.com/embed/";
      // Order of params not important
      const query = `?autoplay=1&mute=1}&controls=0&rel=0&modestbranding=1&playsinline=1&vq=hd1080`;
      document.getElementById("vidFrame").src = base + code + query;

      // Config has the video name, code and duration to be played.
      // Loop through the array of videos and play them one after the other waiting for each to finish.
      config.videos.forEach((video) => {
        const name = video.name;
        const code = video.code;
        const duration = video.run_time; // Duration in minutes

        const base = "https://www.youtube-nocookie.com/embed/";
        const query = `?autoplay=1&mute=1}&controls=0&rel=0&modestbranding=1&playsinline=1&vq=hd1080`;
        document.getElementById("vidFrame").src = base + code + query;
        setTimeout(() => {
          document.getElementById("vidFrame").src = "";
        }, duration * 60 * 1000);
      });

      });
    </script>
  </body>
</html>
